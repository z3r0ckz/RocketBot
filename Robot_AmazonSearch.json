{"project":{"profile":{"name":"Robot_AmazonSearch","description":"Robot que busca en amazon"},"commands":[{"father":"use","command":"{\"tipo\":\"0\",\"url\":\"{URL}\"}","option":"chrome","var":"","index":0,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"cb503825-6b00-7ec8-1560-ac39782bff0e","mode_live":true,"getvar":"","screenshot":"","data_":{"tipo":"0","url":"{URL}"},"execute_debbug":0,"img":"","message":"use chrome {\"tipo\":\"0\",\"url\":\"https://www.amazon.com.mx/\"}","extra":[],"result":"True","description":"Abre la Pagina de Amazon"},{"father":"waitforobject","command":"{\"object\":\"/html/body/div[1]/header/div/div[1]/div[1]/div[1]/a\",\"wait_for\":\"present\",\"wait_time\":\"5\",\"before\":0,\"after\":0}","option":"xpath","var":"","index":1,"group":"web","execute":2,"if":"","description":"Esperamos a que aparezca el logo de Amazon para poder buscar","children":[],"else":[],"id":"dd84c53e-94e8-b0d6-03a1-fe7b26916203","mode_live":true,"getvar":"pagina","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"waitforobject xpath {\"object\":\"/html/body/div[1]/header/div/div[1]/div[1]/div[1]/a\",\"wait_for\":\"present\",\"wait_time\":\"5\",\"before\":0,\"after\":0}","extra":[],"result":"True"},{"father":"evaluateIf","command":"{pagina} == True","option":"","var":"","index":2,"group":"logic","execute":2,"if":"","description":"Si el logo aparece Realizar la siguiente accion","children":[{"father":"clickWeb","command":"/html/body/div[1]/header/div/div[1]/div[2]/div/form/div[3]/div[1]/input","option":"xpath","var":"","index":0,"group":"web","execute":2,"if":"","description":"Da clic en la Barra de buscar de Amazon","children":[],"else":[],"id":"28f1748a-d328-eae6-92f3-cb8d88bdd87f","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"clickweb xpath /html/body/div[1]/header/div/div[1]/div[2]/div/form/div[3]/div[1]/input","extra":[],"result":"True"},{"father":"sendKeyWeb","command":"funko","option":"","var":"","index":1,"group":"web","execute":2,"if":"","description":"Ingresa el texto de funko","children":[],"else":[],"id":"8b72404c-cf37-2158-118a-08de021f9ca3","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"sendkeyweb  funko","extra":[],"result":"True"},{"father":"sendKeyWeb","command":"","option":"ENTER","var":"","index":2,"group":"web","execute":2,"if":"","description":"da enter en la barra de busqueda","children":[],"else":[],"id":"51bd43a4-ac64-05e2-732f-564ee396e76c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"sendkeyweb enter ","extra":[],"result":"True"},{"father":"execJs","command":"return document.getElementsByClassName('a-size-base-plus a-color-base a-text-normal').length","option":"","var":"","index":3,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"2675a33d-06a4-c27f-9217-8e295b055b24","mode_live":true,"getvar":"total","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"execjs  return document.getElementsByClassName('a-size-base-plus a-color-base a-text-normal').length","extra":[],"result":"True","description":"usamos la funcion length para ver cuantos elementos hay"},{"father":"setVar","command":"0","option":"","var":"contador","index":4,"group":"system","execute":2,"if":"","description":"Empezamos nuestro contador en 0 para iterar entre los elementos de la pagina","children":[],"else":[],"id":"66261122-ba75-13cc-840d-6167c89fcffe","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  0","extra":[],"result":"True"},{"father":"setVar","command":"0","option":"","var":"filas","index":5,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"dcb173ae-5292-f079-d529-011d37a6e82f","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""},{"father":"setVar","command":"{total}.decode()","option":"","var":"total","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"6fc6f429-7636-babc-7933-b8c86f853548","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'60'.decode()","extra":[],"result":"True"},{"father":"wait","command":"1","option":"","var":"","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d0416a64-7abf-ad43-2522-3feeb144e31d","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"wait  1","extra":[],"result":"True","description":"Esperamos 1 segundo entre cada iteracion"},{"father":"trycatch","command":"{}","option":"","var":"","index":8,"group":"logic","execute":2,"if":"","description":"Usaremos un try catch para ver que abra bien excel","children":[{"father":"readxlsx","command":"{\"file_path\":\"C:/Users/zeroc/Desktop/Amazon.xlsx\"}","option":"","var":"","index":0,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"5058ab3b-9d21-bbd5-0b87-386c40b43edf","mode_live":true,"getvar":"validar_excel","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"readxlsx  {\"file_path\":\"C:/Users/zeroc/Desktop/Amazon.xlsx\"}","extra":true,"result":"True"},{"father":"evaluateIf","command":"{validar_excel} == True","option":"","var":"","index":1,"group":"logic","execute":2,"if":"","children":[{"father":"evaluatewhile","command":"{contador} <=  {total}","option":"","var":"","index":0,"group":"logic","execute":2,"if":"","description":"Un While para iterar entre todos los elementos de amazon","children":[{"father":"execJs","command":"return document.getElementsByClassName('a-size-base-plus a-color-base a-text-normal')[{contador}].innerText","option":"","var":"","index":0,"group":"web","execute":2,"if":"","description":"Obtenemos el nombre y le pasamos el contador para que vaya iterando entre los objetos","children":[],"else":[],"id":"03bd8bce-4770-dff9-ff18-db2f7c4a9503","mode_live":true,"getvar":"nombre","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"execjs  return document.getElementsByClassName('a-size-base-plus a-color-base a-text-normal')[49].innerText","extra":[],"result":"True"},{"father":"execJs","command":"return document.getElementsByClassName('a-price-whole')[{contador}].InnerText","option":"","var":"","index":1,"group":"web","execute":2,"if":"","description":"Obtenemos el precio y le pasamos el contador para que vaya iterando entre los objetos","children":[],"else":[],"id":"afc32d4b-52af-c0f8-be30-2d768d57d826","mode_live":true,"getvar":"precio","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"execjs  return document.getElementsByClassName('a-price-whole')[49].InnerText","extra":[],"result":"True"},{"father":"setVar","command":"{nombre}.decode(\"latin-1\")","option":"","var":"nombre","index":2,"group":"system","execute":2,"if":"","description":"Decodificamos lo que hay en la variable nombre","children":[],"else":[],"id":"f607d3b6-48ce-5b38-126d-456bda0cf324","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'Funko Pop! Games: Genshin Impact - Paimon, Multicolor'.decode(\"latin-1\")","extra":[],"result":"True"},{"father":"setVar","command":"{precio}.decode()","option":"","var":"precio","index":3,"group":"system","execute":2,"if":"","description":"Decodificamos lo que hay en la variable precio","children":[],"else":[],"id":"bbcf24d8-7d0c-1353-9351-3df8a857bec6","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'None'.decode()","extra":[],"result":"True"},{"father":"setcell","command":"A{contador}={filas}","option":"","var":"","index":4,"group":"excel","execute":2,"if":"","description":"Pasamos el valor de nuestro contador en las filas","children":[],"else":[],"id":"ed651ff2-8e11-7e0c-7667-eac7b559197c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setcell  A{contador}={filas}","extra":false,"result":"True"},{"father":"setcell","command":"B{contador}={nombre}","option":"","var":"","index":5,"group":"excel","execute":2,"if":"","description":"Pasamos el valor del nombre en las filas","children":[],"else":[],"id":"f45eade9-33d8-331d-7c86-7320ac3b1e61","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setcell  B{contador}={nombre}","extra":false,"result":"True"},{"father":"setcell","command":"C{contador}={precio}","option":"","var":"","index":6,"group":"excel","execute":2,"if":"","description":"Pasamos el valor del precio en las filas","children":[],"else":[],"id":"962567a2-7559-a6f0-366f-07f72aff1dee","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setcell  C{contador}={precio}","extra":false,"result":"True"},{"father":"setVar","command":"{contador}+1","option":"","var":"contador","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"7afcbd85-e36f-c2c3-dcd3-3e0ba09f6151","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  48+1","extra":[],"result":"True","description":"Aumentamos el contador"},{"father":"setVar","command":"{filas}+1","option":"","var":"filas","index":8,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"52bb5b3a-a83f-8f14-bdec-11b78a9f3945","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  110+1","extra":[],"result":"True"}],"else":[],"id":"75ffa9a8-4032-82fa-d37b-a32b0d2f3b01","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"evaluatewhile  49 <=  60","extra":{"res":true},"result":"True","minimize":false},{"father":"savexlsx","command":"C:/Users/zeroc/Desktop/Amazon.xlsx","option":"","var":"","index":1,"group":"excel","execute":2,"if":"","description":"Guardamos nuestro archivo","children":[],"else":[],"id":"eade6b6b-bb23-12e0-47a5-f37a0c64b6e8","mode_live":true,"getvar":"validar_excel","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"savexlsx  C:/Users/zeroc/Desktop/Amazon.xlsx","extra":false,"result":"True"},{"father":"quitexcel","command":"","option":"","var":"","index":2,"group":"excel","execute":2,"if":"","description":"Cerramos excel","children":[],"else":[],"id":"fa098489-85d9-860b-2ae7-354073017a5d","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"quitexcel  ","extra":false,"result":"True"},{"father":"trycatch","command":"{}","option":"","var":"","index":3,"group":"logic","execute":2,"if":"","description":"Try catch para el envio de email","children":[{"father":"module","command":"{\"module_name\":\"gmail_\",\"module\":\"conf_mail\",\"from\":\"luis.martinez@ipiam.edu.mx\",\"password\":\"luismf1492\",\"var_\":\"validar_correo\"}","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","description":"Usamos el Mod de Gmail para mandar correo","children":[],"else":[],"id":"e0ceee82-8500-7f42-abcb-dc39ece5e7f0","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"gmail_\",\"module\":\"conf_mail\",\"from\":\"luis.martinez@ipiam.edu.mx\",\"password\":\"luismf1492\",\"var_\":\"validar_correo\"}","extra":[],"result":"True"},{"father":"evaluateIf","command":"{validar_correo} == True","option":"","var":"","index":1,"group":"logic","execute":2,"if":"","children":[{"father":"module","command":"{\"module_name\":\"gmail_\",\"module\":\"send_mail\",\"to\":\"luismf.1492@gmail.com\",\"cc\":\"\",\"subject\":\"Rocketbot lista de precios\",\"body\":\"Mensaje Automatizado de Rocketbot con lista de precios de productos de Amazon\",\"attached_file\":\"C:/Users/zeroc/Desktop/Amazon.xlsx\"}","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","description":"Configuramos los Mails a los que se lo vamos a mandar , le adjuntamos el archivo de excel con la variable que contiene la ruta","children":[],"else":[],"id":"dd6dcb98-f27c-0f3f-0281-a5cec2f11695","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"gmail_\",\"module\":\"send_mail\",\"to\":\"luismf.1492@gmail.com\",\"cc\":\"\",\"subject\":\"Rocketbot lista de precios\",\"body\":\"Mensaje Automatizado de Rocketbot con lista de precios de productos de Amazon\",\"attached_file\":\"C:/Users/zeroc/Desktop/Amazon.xlsx\"}","extra":[],"result":"True"},{"father":"module","command":"{\"module_name\":\"gmail_\",\"module\":\"close\"}","option":"","var":"","index":1,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"912bfbf1-505b-c0f1-ed95-d4d1dd2808b8","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"gmail_\",\"module\":\"close\"}","extra":[],"result":"True"},{"father":"alert","command":"Ejecucion del bot completa","option":"","var":"","index":2,"group":"desktop","execute":2,"if":"","children":[],"else":[],"id":"fab6ff12-da65-1a6c-50ea-a8cfb1cfb397","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""},{"father":"stop","command":"","option":"","var":"","index":3,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"9211883a-baa7-bfb0-d90b-5d32077161a7","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""}],"else":[{"father":"alert","command":"Error al enviar Gmail","option":"","var":"","index":0,"group":"desktop","execute":2,"if":"","children":[],"else":[],"id":"8cc217fa-d628-23f4-9e40-44ce136852ce","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""}],"id":"407669bd-5c6e-fae6-0ba4-61207ff078a2","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"evaluateif  True == True","extra":{"res":"True"},"result":"True"}],"else":[{"father":"alert","command":"Error al acceder a Gmail","option":"","var":"","index":0,"group":"desktop","execute":2,"if":"","children":[],"else":[],"id":"a87b19cc-a625-65fa-caf4-ddd84ea28326","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""}],"id":"eb54b3cd-fb92-8924-22c9-9978de20030e","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"trycatch  {}","extra":{"res":true},"result":"True"}],"else":[{"father":"alert","command":"Falta crear el archivo de excel","option":"","var":"","index":0,"group":"desktop","execute":2,"if":"","children":[],"else":[],"id":"0b69fdd0-f397-5add-e878-808bf795c7c2","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""}],"id":"4053b993-86f0-71c5-6a11-9231c0e241a9","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Si existe el archivo de excel hacer lo siguiente","message":"evaluateif  True == True","extra":{"res":"True"},"result":"True"}],"else":[{"father":"stop","command":"","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"ba3cc2ae-3e5b-1c02-b229-1f51a1d25c4d","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","extra":[],"result":true}],"id":"34aa3ee7-c7ad-df93-7f6e-a8cafd4de723","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","minimize":false,"message":"trycatch  {}","extra":{"res":true},"result":"True"},{"father":"savedatafile","command":"{\"file_name\":\"C:/Users/zeroc/Desktop/log.txt\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"---------------Ejecucion del BOT Exitosa --------------\"}","option":"","var":"","index":9,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"62452c6d-b97f-9b69-23f4-ebfe821f98a5","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"savedatafile  {\"file_name\":\"C:/Users/zeroc/Desktop/log.txt\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"Fecha Fin: {fecha_fin}\"}","extra":[],"result":"True"}],"else":[{"father":"alert","command":"El bot fallo al ejecutar la busqueda de Amazon","option":"","var":"","index":0,"group":"desktop","execute":2,"if":"","children":[],"else":[],"id":"1d13fd1b-9ad0-843e-b5e5-69a8167ef525","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""}],"id":"17f51a0b-80c9-6484-6308-ecc9995a919b","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"evaluateif  True == True","extra":{"res":"True"},"result":"True","minimize":false}],"vars":[{"name":"nombre","data":"Funko Pop! Games: Genshin Impact - Paimon, Multicolor","type":"string","collapse":true,"$$hashKey":"object:25053"},{"name":"precio","data":"None","type":"string","collapse":true,"$$hashKey":"object:25054"},{"name":"contador","data":"","type":"string","collapse":true,"$$hashKey":"object:25055"},{"name":"total","data":"60","type":"string","collapse":true,"$$hashKey":"object:25056"},{"name":"pagina","data":"True","type":"string","collapse":true,"$$hashKey":"object:25057"},{"name":"URL","data":"https://www.amazon.com.mx/","type":"string","collapse":true,"$$hashKey":"object:25058"},{"name":"excel_path","data":"C:\\Users\\zeroc\\Desktop\\Amazon.xlsx","type":"string","collapse":true,"$$hashKey":"object:25059"},{"name":"filas","data":"","type":"string","collapse":true,"$$hashKey":"object:25060"},{"name":"validar_excel","data":"True","type":"string","collapse":true,"$$hashKey":"object:25061"},{"name":"validar_correo","data":"True","type":"string","collapse":true,"$$hashKey":"object:25062"}],"ifs":[{"id":"c3b85362-7311-4ec9-41e9-18130e77332d","status":null},{"id":"37484499-0188-330c-9c16-fe32e3786348","status":null},{"id":"92e7efa2-8b89-9e03-838f-e23bb008c1b0","status":null},{"id":"a706be5d-1cf2-8d1a-1510-c9d873589ddc","status":null},{"id":"c1639a7b-a0f5-0dff-d696-4a9e165c028c","status":null},{"id":"00c87129-a0f3-bacb-06c4-71381a9d038e","status":null},{"id":"02d6534a-3938-af05-ec60-e2f68610f1ed","status":null},{"id":"bf3f4f43-4d02-cbaa-a2cd-e38ed33c87b5","status":null},{"id":"b5dac1de-e3b2-bd60-9d37-3227a148e81b","status":null},{"id":"b13bb36b-cb8f-b88e-f272-befe7c71a778","status":null},{"id":"2f2a8b97-8750-c996-961a-208d177ff9e9","status":null},{"id":"30155f32-e468-8d06-71e6-1abe0844419e","status":null},{"id":"d7d81da2-fa5b-ff93-535c-959f98cbc896","status":null},{"id":"a3ea498e-49fe-6267-58a9-93d2b0582922","status":null},{"id":"c0f994af-aad8-4f1c-e9d3-f8a293dfacc9","status":null},{"id":"7c72389e-612f-c8c7-4cd9-921dc4cec96f","status":null},{"id":"dbd88348-58e9-1490-c77d-646ba8186b0e","status":null},{"id":"48551d12-b61e-f85e-d128-2c317a24e2eb","status":null},{"id":"858001cb-7f96-dc72-ee01-e1d97bb3f910","status":null},{"id":"ff6bc4e4-1e6e-ef94-5ce5-5b3469fa2785","status":null},{"id":"8446c547-fd02-deda-4a24-1877da135e21","status":null}]}}